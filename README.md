# lovets18
## HMs for ML PROD course 2022
### homework2

#### Описание проекта:
Программу можно запускать для обучения, для предсказания и сразу для обучения и предсказания 
(имеется ввиду поочередно за один запуск, управляется конфигами)

Установка: pip install -r requirements.txt

Запуск сборки контейнера docker: docker build -t lovets18/hm2:v1 -f online_inference/Dockerfile .

Скачивание образа docker: docker pull lovets18/hm2:v1

Запуск собранного docker: docker run -it -p 8888:8888 lovets18/hm2:v1

Запрос: python -m online_inference.online_request

tests - директория с файлами для тестов

tests/test_app.py - тестирование для онлайн предсказания

online_inference - директория для онлайн предсказания

online_inference/app.py - сервер

online_inference/online_predict.py - классы и функции для предсказания

online_inference/online_request.py - запрос к серверу

online_inference/Dockerfile - файл с инструкциями для docker

Папка configs содержит примеры конфигураций для запуска модели, в зависимости от параметров, по-разному проводится обработка данных,
спользуются разные модели машинного обучения

В конфиге model_path - путь, по которому сохранится или прочитается модель
Для запуска обучения необходимо указать путь к данным для обучения train_data, hyperparams, train_test_split, для предсказания - test_data и output_data.
При указании всех данных, сначала проведется обучение, а затем предскащание

Основной код расположен в папке ml_project

ml_project/main.py - главный файл для запуска модели (аргументом нужно указать путь к конфигу)

ml_project/predict.py - модуль для обучения

ml_project/train.py - модель для предсказания

ml_project/preprocess.py - модуль для предобработки данных

ml_project/dataclasses - содержит классы ддя пасринг конфига

ml_project/logs - для логирования

ml_project/train_constaints - сохранение mean и std для нормализации данных

output - для результаов предсказаний

models - для .pkl файлов предобученных моделей

notebooks - для jupyter ноутбуков



#### Критерии (указаны максимальные баллы, по каждому критерию ревьюер может поставить баллы частично):

1) Оберните inference вашей модели в rest сервис на FastAPI, должен быть endpoint /predict (3 балла)

2) Напишите endpoint /health (1 балл), должен возращать 200, если ваша модель готова к работе (такой чек особенно актуален если делаете доп задание про скачивание из хранилища)

3) Напишите unit тест для /predict (3 балла) (https://fastapi.tiangolo.com/tutorial/testing/, https://flask.palletsprojects.com/en/1.1.x/testing/)

4) Напишите скрипт, который будет делать запросы к вашему сервису -- 2 балла

5) Напишите dockerfile, соберите на его основе образ и запустите локально контейнер(docker build, docker run), внутри контейнера должен запускать сервис, написанный в предущем пункте, закоммитьте его, напишите в readme корректную команду сборки (4 балл)

6) опубликуйте образ в https://hub.docker.com/, используя docker push (вам потребуется зарегистрироваться) (+2 балла)

7) напишите в readme корректные команды docker pull/run, которые должны привести к тому, что локально поднимется на inference ваша модель (1 балл) Убедитесь, что вы можете протыкать его скриптом из пункта 3

8) проведите самооценку(распишите в реквесте какие пункты выполнили и на сколько баллов, укажите сумму баллов) -- 1 балл